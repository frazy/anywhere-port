# AnywherePort

AnywherePort æ˜¯ä¸€æ¬¾åŸºäº Go è¯­è¨€å¼€å‘çš„è½»é‡çº§ã€é«˜æ€§èƒ½åˆ†å¸ƒå¼ç«¯å£è½¬å‘å·¥å…·ã€‚å®ƒé‡‡ç”¨ Master-Agent æ¶æ„ï¼Œé€šè¿‡ WebSocket å»ºç«‹ç¨³å®šçš„æ§åˆ¶åŒå‘é€šé“ï¼Œå¯è½»æ¾å®ç°å¤šèŠ‚ç‚¹æµé‡è½¬å‘ä¸ç»Ÿä¸€ç®¡ç†ã€‚

## ğŸŒŸ æ ¸å¿ƒç‰¹æ€§

- **ğŸš€ é«˜æ€§èƒ½è½¬å‘**: åŸºäº Go åŸç”Ÿç½‘ç»œåº“ï¼Œæ”¯æŒ TCP å’Œ UDP æµé‡çš„é«˜æ•ˆè½¬å‘ã€‚
- **ğŸ—ï¸ åˆ†å¸ƒå¼æ¶æ„**: å•ä¸ª Master å¯ç®¡ç†å¤šä¸ª Agent èŠ‚ç‚¹ï¼Œæ”¯æŒè·¨ç½‘ç»œç¯å¢ƒéƒ¨ç½²ã€‚
- **ğŸ“Š Web ç®¡ç†é¢æ¿**: æä¾›å‹å¥½çš„ç½‘é¡µæ“ä½œç•Œé¢ï¼Œå®æ—¶æŸ¥çœ‹èŠ‚ç‚¹çŠ¶æ€å¹¶ç®¡ç†è½¬å‘è§„åˆ™ã€‚
- **ğŸ›¡ï¸ çµæ´»è®¤è¯**: å†…ç½®å®‰å…¨è®¤è¯æœºåˆ¶ï¼Œæ”¯æŒ Token æ ¡éªŒï¼Œç¡®ä¿ Master ä¸ Agent ä¹‹é—´çš„é€šä¿¡å®‰å…¨ã€‚
- **ğŸ“¦ é›¶ä¾èµ–éƒ¨ç½²**: é™æ€èµ„æºå…¨å†…ç½®ï¼ŒäºŒè¿›åˆ¶æ–‡ä»¶å³ä¸‹å³ç”¨ï¼Œæ— éœ€é¢å¤–å®‰è£…è¿è¡Œç¯å¢ƒã€‚

## ğŸ› ï¸ æŠ€æœ¯æ¶æ„

AnywherePort ç”±ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶ç»„æˆï¼š

1.  **Master (æ§åˆ¶ç«¯)**: è´Ÿè´£å…¨å±€é…ç½®ç®¡ç†ã€Web UI å±•ç¤ºã€API æ¥å£æä¾›ä»¥åŠä¸å„ Agent çš„åè°ƒé€šä¿¡ã€‚
2.  **Agent (èŠ‚ç‚¹ç«¯)**: éƒ¨ç½²åœ¨æµé‡å‡ºå…¥å£ï¼Œæ ¹æ® Master æŒ‡ä»¤æ‰§è¡Œå®é™…çš„ç«¯å£ç›‘å¬ä¸æ•°æ®è½¬å‘ä»»åŠ¡ã€‚

```mermaid
graph LR
    User([ç”¨æˆ·/æµè§ˆå™¨]) -- HTTP/WS --> Master[AnywherePort Master]
    Master -- æ§åˆ¶é€šé“ (WS) --> Agent1[Agent A]
    Master -- æ§åˆ¶é€šé“ (WS) --> Agent2[Agent B]
    
    Inflow((å¤–éƒ¨æµé‡)) -- TCP/UDP --> Agent1
    Agent1 -- è½¬å‘ --> Target1[ç›®æ ‡æœåŠ¡ A]
    
    Inflow2((å¤–éƒ¨æµé‡)) -- TCP/UDP --> Agent2
    Agent2 -- è½¬å‘ --> Target2[ç›®æ ‡æœåŠ¡ B]
    
    subgraph Master Node
        Master
    end
    
    subgraph Remote Agent A
        Agent1
    end
    
    subgraph Remote Agent B
        Agent2
    end
```

---

## ğŸš€ éƒ¨ç½²æŒ‡å—

æœ¬æŒ‡å—è¯¦ç»†è¯´æ˜äº† AnywherePort çš„ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æµç¨‹ã€‚

### 1. Master (æœåŠ¡ç«¯) éƒ¨ç½²

Master è´Ÿè´£ Web ç®¡ç†ç•Œé¢ã€è®¤è¯ä»¥åŠåè°ƒå„ Agent èŠ‚ç‚¹ã€‚

#### 1.1 æ‰€éœ€æ–‡ä»¶

| æ–‡ä»¶ | è¯´æ˜ |
| :--- | :--- |
| **`awport-master`** | ä¸»ç¨‹åºäºŒè¿›åˆ¶æ–‡ä»¶ (Windows ä¸º `.exe`) |
| **`config.yml`** | é…ç½®æ–‡ä»¶ (éœ€ä¸ç¨‹åºåŒçº§) |

> **æ³¨æ„**: Web é™æ€èµ„æºå·²æ‰“åŒ…è¿›äºŒè¿›åˆ¶æ–‡ä»¶ï¼Œ**æ— éœ€**é¢å¤–éƒ¨ç½²å…¶ä»–ç›®å½•ã€‚

#### 1.2 `config.yml` é…ç½®ç¤ºä¾‹

```yaml
# Web ç®¡ç†é¢æ¿ç›‘å¬åœ°å€
web_addr: ":9090"

# å¤–éƒ¨å¯è¾¾åœ°å€ (éœ€åŒ…å«åè®®) - ç”¨äºè‡ªåŠ¨ç”Ÿæˆ Agent è¿æ¥è„šæœ¬
public_addr: "http://your-ip-or-domain:9090"

# æ•°æ®å­˜å‚¨ç›®å½• (é»˜è®¤ä¸º ./data)
data_dir: "./data"

# ç®¡ç†å‘˜è®¤è¯é…ç½®
auth:
  username: "admin"
  password: "YourStrongPassword" # è¯·åŠ¡å¿…ä¿®æ”¹é»˜è®¤å¯†ç 
```

#### 1.3 å¯åŠ¨å‘½ä»¤

**Linux:**
```bash
nohup ./awport-master > master.log 2>&1 &
```

**Windows:**
```powershell
.\awport-master.exe
```

---

### 2. Agent (å®¢æˆ·ç«¯) éƒ¨ç½²

Agent è´Ÿè´£å®é™…çš„æµé‡è½¬å‘ï¼Œéƒ¨ç½²åœ¨ç›®æ ‡æœºå™¨ä¸Šã€‚

#### 2.1 å¯åŠ¨æµç¨‹

1.  **è·å–å‡­æ®**: ç™»å½• Master Web ç•Œé¢ -> "èŠ‚ç‚¹ç®¡ç†" -> "æ·»åŠ èŠ‚ç‚¹" -> è·å– `Agent ID` å’Œ `Token`ã€‚
2.  **å¯åŠ¨å‘½ä»¤**:
    - **Linux**: `nohup ./awport-agent -master <MasterIP>:9090 -id <ID> -token <Token> > agent.log 2>&1 &`
    - **Windows**: `.\awport-agent.exe -master <MasterIP>:9090 -id <ID> -token <Token>`

> **æç¤º**: Master Web ç•Œé¢åœ¨æ·»åŠ èŠ‚ç‚¹åä¼šæä¾›ä¸€é”®å¯åŠ¨è„šæœ¬ï¼ˆåŸºäº curl æˆ– PowerShellï¼‰ï¼Œæ¨èç›´æ¥å¤åˆ¶æ‰§è¡Œã€‚

---

## ğŸ’» æœ¬åœ°å¼€å‘

å¦‚æœä½ æƒ³è‡ªè¡Œç¼–è¯‘æˆ–è¿›è¡ŒäºŒæ¬¡å¼€å‘ï¼š

1. å…‹éš†ä»“åº“: `git clone https://github.com/frazy/anywhere-port.git`
2. å®‰è£…ä¾èµ–: `go mod tidy`
3. ç¼–è¯‘ Master: `go build -o awport-master ./cmd/master`
4. ç¼–è¯‘ Agent: `go build -o awport-agent ./cmd/agent`

---

## ğŸ“ å¸¸è§é—®é¢˜ (FAQ)

- **æ•°æ®æŒä¹…åŒ–**: æ•°æ®ä¿å­˜åœ¨ `data/` ç›®å½•ï¼ŒåŒ…æ‹¬èŠ‚ç‚¹ä¿¡æ¯å’Œç»Ÿè®¡æ•°æ®ã€‚
- **é˜²ç«å¢™**: ç¡®ä¿å¼€æ”¾äº† Master çš„ Web ç«¯å£ï¼ˆé»˜è®¤ 9090ï¼‰ä»¥åŠæ‰€éœ€çš„è½¬å‘ç«¯å£ã€‚
- **é€šä¿¡åè®®**: å†…éƒ¨é‡‡ç”¨ WebSocketï¼Œç¡®ä¿ç½‘ç»œç¯å¢ƒä¸é˜»æ–­è¯¥åè®®ã€‚

---

## ğŸ“„ å¼€æºåè®®

[MIT License](LICENSE)
